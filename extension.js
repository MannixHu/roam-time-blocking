/*! For license information please see extension.js.LICENSE.txt */
var e={20(e,n,t){var o=t(594),r=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function s(e,n,t){var o,s={},c=null,d=null;for(o in void 0!==t&&(c=""+t),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(d=n.ref),n)a.call(n,o)&&!l.hasOwnProperty(o)&&(s[o]=n[o]);if(e&&e.defaultProps)for(o in n=e.defaultProps)void 0===s[o]&&(s[o]=n[o]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:i.current}}n.jsx=s,n.jsxs=s},56(e,n,t){e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72(e){var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var a={},i=[],l=0;l<e.length;l++){var s=e[l],c=o.base?s[0]+o.base:s[0],d=a[c]||0,u="".concat(c," ").concat(d);a[c]=d+1;var p=t(u),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)n[p].references++,n[p].updater(m);else{var f=r(m,o);o.byIndex=l,n.splice(l,0,{identifier:u,updater:f,references:1})}i.push(u)}return i}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var l=t(a[i]);n[l].references--}for(var s=o(e,r),c=0;c<a.length;c++){var d=t(a[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}a=s}}},113(e){e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),n.push(d))}},n}},540(e){e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},594(e){e.exports=React},601(e){e.exports=function(e){return e[1]}},628(e,n,t){t.d(n,{A:()=>l});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,'/* TimeBlock Sidebar Styles */\n\n#timeblock-sidebar-container {\n  width: 100%;\n  border-bottom: 1px solid var(--border-color, #e0e0e0);\n}\n\n.timeblock-sidebar {\n  display: flex;\n  flex-direction: column;\n  height: 450px;\n  max-height: 60vh;\n  width: 100%;\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n  font-size: 12px;\n  background: var(--background-color, #fff);\n}\n\n/* Header */\n.timeblock-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  border-bottom: 1px solid var(--border-color, #e0e0e0);\n  flex-shrink: 0;\n}\n\n.timeblock-title {\n  font-weight: 600;\n  font-size: 13px;\n  color: var(--text-color, #333);\n}\n\n.timeblock-refresh-btn {\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  color: var(--text-secondary, #666);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.timeblock-refresh-btn:hover {\n  background: var(--hover-bg, #f0f0f0);\n}\n\n.timeblock-refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Tag Selector */\n.timeblock-tag-selector {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n  padding: 8px 12px;\n  border-bottom: 1px solid var(--border-color, #e0e0e0);\n  flex-shrink: 0;\n}\n\n.timeblock-tag-btn {\n  padding: 4px 10px;\n  border: 2px solid;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.15s ease;\n  background: transparent;\n}\n\n.timeblock-tag-btn:hover {\n  opacity: 0.85;\n  transform: scale(1.02);\n}\n\n.timeblock-tag-btn.selected {\n  font-weight: 600;\n}\n\n/* Loading */\n.timeblock-loading {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: var(--text-secondary, #666);\n}\n\n/* Grid */\n.timeblock-grid {\n  flex: 1;\n  display: flex;\n  overflow-y: auto;\n  position: relative;\n  user-select: none;\n  cursor: crosshair;\n}\n\n.timeblock-hour-labels {\n  width: 45px;\n  flex-shrink: 0;\n  border-right: 1px solid var(--border-color, #e0e0e0);\n  background: var(--background-color, #fff);\n}\n\n.timeblock-hour-label {\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-end;\n  padding-right: 6px;\n  padding-top: 2px;\n  font-size: 10px;\n  color: var(--text-secondary, #888);\n}\n\n.timeblock-blocks-container {\n  flex: 1;\n  position: relative;\n  min-height: 100%;\n}\n\n.timeblock-hour-line {\n  position: absolute;\n  left: 0;\n  right: 0;\n  height: 1px;\n  background-color: var(--border-color, #e0e0e0);\n  pointer-events: none;\n}\n\n.timeblock-half-hour-line {\n  position: absolute;\n  left: 0;\n  right: 0;\n  height: 1px;\n  background-color: var(--border-light, #f0f0f0);\n  pointer-events: none;\n}\n\n/* Time Block */\n.timeblock-block {\n  position: absolute;\n  left: 4px;\n  right: 4px;\n  border-radius: 4px;\n  padding: 2px 6px;\n  cursor: pointer;\n  overflow: hidden;\n  transition: box-shadow 0.15s ease, transform 0.1s ease;\n  z-index: 1;\n}\n\n.timeblock-block:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  transform: translateX(2px);\n  z-index: 2;\n}\n\n.timeblock-block-time {\n  font-size: 9px;\n  font-weight: 600;\n  opacity: 0.9;\n  color: rgba(0, 0, 0, 0.7);\n}\n\n.timeblock-block-text {\n  font-size: 10px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: rgba(0, 0, 0, 0.8);\n  margin-top: 1px;\n}\n\n/* Drag Selection */\n.timeblock-drag-selection {\n  position: absolute;\n  left: 4px;\n  right: 4px;\n  background-color: rgba(66, 133, 244, 0.25);\n  border: 2px dashed #4285f4;\n  border-radius: 4px;\n  pointer-events: none;\n  z-index: 10;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.timeblock-drag-time {\n  font-size: 10px;\n  font-weight: 600;\n  color: #4285f4;\n  background: rgba(255, 255, 255, 0.9);\n  padding: 2px 6px;\n  border-radius: 3px;\n}\n\n/* Footer */\n.timeblock-footer {\n  padding: 6px 12px;\n  border-top: 1px solid var(--border-color, #e0e0e0);\n  font-size: 10px;\n  color: var(--text-secondary, #888);\n  text-align: center;\n  flex-shrink: 0;\n}\n\n/* Dark mode support (Roam\'s CSS variables) */\n.rm-dark-theme .timeblock-sidebar {\n  background: var(--background-color, #1a1a1a);\n}\n\n.rm-dark-theme .timeblock-title {\n  color: var(--text-color, #e0e0e0);\n}\n\n.rm-dark-theme .timeblock-block-time,\n.rm-dark-theme .timeblock-block-text {\n  color: rgba(255, 255, 255, 0.85);\n}\n',""]);const l=i},659(e){var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},848(e,n,t){e.exports=t(20)}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var a=n[o]={id:o,exports:{}};return e[o](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;const o={dayStartHour:6,dayEndHour:22,configuredTags:[{tag:"longTerm",color:"#4A90D9",isPageRef:!1},{tag:"shortTerm",color:"#7CB342",isPageRef:!1}],defaultColor:"#9E9E9E"};function r(e){const n=Math.min(23,Math.max(0,Number(e.settings.get("dayStartHour"))||o.dayStartHour)),t=Number(e.settings.get("dayEndHour"))||o.dayEndHour,r=Math.min(30,Math.max(0,t)),a=e.settings.get("defaultColor")||o.defaultColor,i=function(e,n,t){if(!e.trim())return[];const o=new Map;return n.trim()&&n.split(",").forEach(e=>{const[n,t]=e.split(":").map(e=>e.trim());n&&t&&o.set(n.toLowerCase(),t)}),e.split(",").map(e=>{const n=e.trim(),r=n.startsWith("[[")&&n.endsWith("]]"),a=r?n.slice(2,-2):n.replace(/^#/,""),i=o.get(a.toLowerCase())||t;return{tag:a,color:i,isPageRef:r}})}(e.settings.get("timeBlockTags")||"",e.settings.get("tagColors")||"",a);return{dayStartHour:n,dayEndHour:r,configuredTags:i.length>0?i:o.configuredTags,defaultColor:a}}var a=t(848),i=t(594);const l=ReactDOM;var s=t.n(l);const c=[{pattern:/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})(?!\s*[ap])/i,parse:e=>({startHour:parseInt(e[1],10),startMinute:parseInt(e[2],10),endHour:parseInt(e[3],10),endMinute:parseInt(e[4],10),originalText:e[0]})},{pattern:/(\d{1,2}):(\d{2})\s*(am|pm)\s*-\s*(\d{1,2}):(\d{2})\s*(am|pm)/i,parse:e=>({startHour:d(parseInt(e[1],10),e[3]),startMinute:parseInt(e[2],10),endHour:d(parseInt(e[4],10),e[6]),endMinute:parseInt(e[5],10),originalText:e[0]})},{pattern:/(\d{1,2})\s*(am|pm)\s*-\s*(\d{1,2})\s*(am|pm)/i,parse:e=>({startHour:d(parseInt(e[1],10),e[2]),startMinute:0,endHour:d(parseInt(e[3],10),e[4]),endMinute:0,originalText:e[0]})}];function d(e,n){const t="pm"===n.toLowerCase();return 12===e?t?12:0:t?e+12:e}function u(e){for(const{pattern:n,parse:t}of c){const o=e.match(n);if(o){const e=t(o);if(p(e))return e}}return null}function p(e){const{startHour:n,startMinute:t,endHour:o,endMinute:r}=e;return!(n<0||n>23||o<0||o>23)&&(!(t<0||t>59||r<0||r>59)&&60*o+r>=60*n+t)}function m(e,n){const t=e=>e.toString().padStart(2,"0");return`${t(e)}:${t(n)}`}function f(e){const n=window.roamAlphaAPI.pull("[:block/string]",[":block/uid",e]);return n?.[":block/string"]||""}function g(e){const n=window.roamAlphaAPI.pull("[{:block/parents [:block/uid]}]",[":block/uid",e]),t=n?.[":block/parents"];return t?.[0]?.[":block/uid"]||null}function h(){return window.roamAlphaAPI.util.dateToPageTitle(new Date)}function b(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function k(e){return e.isPageRef?new RegExp(`(\\[\\[${b(e.tag)}\\]\\]|#\\[\\[${b(e.tag)}\\]\\])`):new RegExp(`#${b(e.tag)}(?![\\w-])`)}function x(e,n){if(0===n.length)return null;const t=n.map(e=>({config:e,regex:k(e)}));let o=e;for(;o;){const e=f(o);for(const{config:n,regex:o}of t)if(o.test(e))return n;o=g(o)}return null}function v(e,n,t=!1,o=5){const r=function(e){return window.roamAlphaAPI.q("\n    [:find ?uid ?string ?order ?parent-uid\n     :in $ ?title\n     :where\n       [?page :node/title ?title]\n       [?block :block/page ?page]\n       [?block :block/uid ?uid]\n       [?block :block/string ?string]\n       [?block :block/order ?order]\n       [?block :block/parents ?parent]\n       [?parent :block/uid ?parent-uid]]\n  ",e).map(([e,n,t,o])=>({uid:e,string:n,order:t,parentUid:o}))}(e),a=[];for(const e of r){const r=u(e.string);if(r){if(t&&r.startHour>=o)continue;const i=x(e.uid,n);if(i||0===n.length){const n=t?{...r,startHour:r.startHour+24,endHour:r.endHour+24}:r;a.push({uid:e.uid,text:e.string,timeRange:n,tag:i,parentUid:e.parentUid,order:e.order})}}}return a}const y=({data:e,startHour:n,pixelsPerHour:t,onClick:o})=>{const{timeRange:r,tag:i,text:l}=e,s=60*r.startHour+r.startMinute,c=60*r.endHour+r.endMinute-s,d=(s-60*n)/60*t,u=Math.max(c/60*t,20),p=i?.color||"#cccccc",f=function(e){const n=e.replace("#",""),t=parseInt(n,16);return`#${(Math.max(0,(t>>16)-Math.round(51))<<16|Math.max(0,(t>>8&255)-Math.round(51))<<8|Math.max(0,(255&t)-Math.round(51))).toString(16).padStart(6,"0")}`}(p),g=l.replace(r.originalText,"").trim(),h=`${m(r.startHour,r.startMinute)}-${m(r.endHour,r.endMinute)}`;return(0,a.jsxs)("div",{className:"timeblock-block",style:{top:`${d}px`,height:`${u}px`,backgroundColor:p,borderLeft:`4px solid ${f}`},onClick:o,title:l,children:[(0,a.jsx)("div",{className:"timeblock-block-time",children:h}),u>30&&(0,a.jsx)("div",{className:"timeblock-block-text",children:g||(i?.tag?`#${i.tag}`:"")})]})},w=({selection:e,color:n})=>{const t=n?`${n}40`:"rgba(66, 133, 244, 0.25)",o=n||"#4285f4";return(0,a.jsx)("div",{className:"timeblock-drag-selection",style:{top:`${e.top}px`,height:`${Math.max(e.height,15)}px`,backgroundColor:t,borderColor:o},children:(0,a.jsxs)("span",{className:"timeblock-drag-time",style:{color:o},children:[e.startTime," - ",e.endTime]})})},T=60;function C(e){const n=e%24,t=e=>e.toString().padStart(2,"0");return e>=24?`${t(n)}:00 +1`:`${t(n)}:00`}const M=({startHour:e,endHour:n,timeBlocks:t,onBlockClick:o,onCreateBlock:r,selectedTagColor:l,dayBoundaryHour:s=5})=>{const c=(0,i.useRef)(null),[d,u]=(0,i.useState)(!1),[p,f]=(0,i.useState)(null),[g,h]=(0,i.useState)(null),b=n<=e?n+24:n,k=Array.from({length:b-e},(n,t)=>e+t),x=(0,i.useCallback)(n=>{if(!c.current)return 0;const t=(n-c.current.getBoundingClientRect().top+c.current.scrollTop)/T*60+60*e;return function(e){return 15*Math.round(e/15)}(Math.max(60*e,Math.min(60*b,t)))},[e,b]),v=(0,i.useCallback)(e=>{if(e.target.closest(".timeblock-block"))return;const n=x(e.clientY);u(!0),f(n),h(n)},[x]),M=(0,i.useCallback)(e=>{if(!d)return;const n=x(e.clientY);h(n)},[d,x]),S=(0,i.useCallback)(()=>{if(!d||null===p||null===g)return u(!1),f(null),void h(null);const e=Math.min(p,g),n=Math.max(p,g),t=Math.max(n,e+15);if(t>e){const n=Math.floor(e/60),o=e%60,a=Math.floor(t/60);r(n,o,a,t%60)}u(!1),f(null),h(null)},[d,p,g,r]),A=(0,i.useCallback)(()=>{d&&(u(!1),f(null),h(null))},[d]),H=d&&null!==p&&null!==g?(()=>{const n=Math.min(p,g),t=Math.max(p,g),o=Math.max(t,n+15),r=(n-60*e)/60*T,a=(o-n)/60*T,i=Math.floor(n/60),l=n%60,s=Math.floor(o/60),c=o%60;return{top:r,height:a,startTime:m(i,l),endTime:m(s,c)}})():null;return(0,a.jsxs)("div",{ref:c,className:"timeblock-grid",onMouseDown:v,onMouseMove:M,onMouseUp:S,onMouseLeave:A,children:[(0,a.jsx)("div",{className:"timeblock-hour-labels",children:k.map(e=>(0,a.jsx)("div",{className:"timeblock-hour-label",style:{height:T},children:C(e)},e))}),(0,a.jsxs)("div",{className:"timeblock-blocks-container",children:[k.map(n=>(0,a.jsx)("div",{className:"timeblock-hour-line",style:{top:(n-e)*T}},n)),k.map(n=>(0,a.jsx)("div",{className:"timeblock-half-hour-line",style:{top:(n-e)*T+30}},`${n}-half`)),t.map(n=>(0,a.jsx)(y,{data:n,startHour:e,pixelsPerHour:T,onClick:()=>o(n.uid)},n.uid)),H&&(0,a.jsx)(w,{selection:H,color:l})]})]})};function S(e){return e>24?e-24:0}const A=({extensionAPI:e})=>{const[n,t]=(0,i.useState)([]),[o,l]=(0,i.useState)(null),[s,c]=(0,i.useState)(!0),[d,u]=(0,i.useState)(""),[p,m]=(0,i.useState)(null),f=(0,i.useCallback)(()=>{if(o){c(!0);try{const e=S(o.dayEndHour),n=function(e,n=5){const t=h(),o=function(){const e=new Date;return e.setDate(e.getDate()+1),window.roamAlphaAPI.util.dateToPageTitle(e)}();return[...v(t,e,!1,n),...v(o,e,!0,n)].sort((e,n)=>60*e.timeRange.startHour+e.timeRange.startMinute-(60*n.timeRange.startHour+n.timeRange.startMinute))}(o.configuredTags,e);t(n),u(h())}catch(e){console.error("[TimeBlock] Error scanning for time blocks:",e)}finally{c(!1)}}},[o]);(0,i.useEffect)(()=>{const n=r(e);l(n),n.configuredTags.length>0&&m(n.configuredTags[0])},[e]),(0,i.useEffect)(()=>{o&&f()},[o,f]),(0,i.useEffect)(()=>{const e=setInterval(f,3e4);return()=>clearInterval(e)},[f]),(0,i.useEffect)(()=>{if(!o)return;let e=null;const n=h(),t=`[:node/title "${n}"]`,r=(n,t)=>{e&&clearTimeout(e),e=setTimeout(()=>{console.log("[TimeBlock] Data changed, refreshing..."),f()},300)};let a=null;try{window.roamAlphaAPI.data?.addPullWatch?(a=window.roamAlphaAPI.data.addPullWatch("[:block/string :block/uid {:block/children ...}]",t,r),console.log("[TimeBlock] Pull watch added for:",n)):console.log("[TimeBlock] addPullWatch not available, using fallback")}catch(e){console.warn("[TimeBlock] Could not add pull watch:",e)}return()=>{if(e&&clearTimeout(e),null!==a&&window.roamAlphaAPI.data?.removePullWatch)try{window.roamAlphaAPI.data.removePullWatch(a),console.log("[TimeBlock] Pull watch removed")}catch(e){console.warn("[TimeBlock] Could not remove pull watch:",e)}}},[o,f]);const g=(0,i.useCallback)(e=>{var n;n=e,window.roamAlphaAPI.ui.mainWindow.openBlock({block:{uid:n}})},[]),b=(0,i.useCallback)(async(e,n,t,o)=>{try{await async function(e,n,t,o,r,a){const i=h(),l=function(e){const n=window.roamAlphaAPI.q("[:find ?uid :in $ ?title :where [?page :node/title ?title] [?page :block/uid ?uid]]",e);return n[0]?.[0]||null}(i);if(!l)throw new Error(`Could not find page: ${i}`);const s=function(e,n,t,o){const r=e=>e.toString().padStart(2,"0");return`${r(e)}:${r(n)}-${r(t)}:${r(o)}`}(e,n,t,o);let c=s;a&&(c+=` #${a} `);const d=Math.random().toString(36).substring(2,11);if(r){const e=function(e){const n=window.roamAlphaAPI.q("\n    [:find ?parent-uid ?order\n     :in $ ?uid\n     :where\n       [?block :block/uid ?uid]\n       [?block :block/order ?order]\n       [?block :block/parents ?parent]\n       [?parent :block/uid ?parent-uid]]\n  ",e);return 0===n.length?null:{parentUid:n[0][0],order:n[0][1]}}(r);e?await window.roamAlphaAPI.createBlock({location:{"parent-uid":e.parentUid,order:e.order+1},block:{string:c,uid:d}}):await window.roamAlphaAPI.createBlock({location:{"parent-uid":l,order:"last"},block:{string:c,uid:d}})}else await window.roamAlphaAPI.createBlock({location:{"parent-uid":l,order:"last"},block:{string:c,uid:d}});return d}(e,n,t,o,void 0,p?.tag),f()}catch(e){console.error("[TimeBlock] Error creating time block:",e)}},[p,f]);return o?(0,a.jsxs)("div",{className:"timeblock-sidebar",children:[(0,a.jsxs)("div",{className:"timeblock-header",children:[(0,a.jsx)("div",{className:"timeblock-title",children:d||"Today"}),(0,a.jsx)("button",{className:"timeblock-refresh-btn",onClick:f,title:"Refresh",disabled:s,children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:(0,a.jsx)("path",{d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})})]}),o.configuredTags.length>0&&(0,a.jsx)("div",{className:"timeblock-tag-selector",children:o.configuredTags.map(e=>(0,a.jsxs)("button",{className:"timeblock-tag-btn "+(p?.tag===e.tag?"selected":""),style:{backgroundColor:p?.tag===e.tag?e.color:"transparent",borderColor:e.color,color:p?.tag===e.tag?"#fff":e.color},onClick:()=>m(e),children:["#",e.tag]},e.tag))}),s?(0,a.jsx)("div",{className:"timeblock-loading",children:"Loading..."}):(0,a.jsx)(M,{startHour:o.dayStartHour,endHour:o.dayEndHour,timeBlocks:n,onBlockClick:g,onCreateBlock:b,selectedTagColor:p?.color,dayBoundaryHour:S(o.dayEndHour)}),(0,a.jsxs)("div",{className:"timeblock-footer",children:[n.length," time block",1!==n.length?"s":""]})]}):(0,a.jsx)("div",{className:"timeblock-sidebar",children:(0,a.jsx)("div",{className:"timeblock-loading",children:"Loading settings..."})})};let H=null,B=null;function E(){H&&(H.unmount(),H=null),B&&B.parentNode&&B.parentNode.removeChild(B),B=null}var I=t(72),P=t.n(I),j=t(825),N=t.n(j),$=t(659),R=t.n($),_=t(56),D=t.n(_),L=t(540),z=t.n(L),O=t(113),U=t.n(O),W=t(628),F={};F.styleTagTransform=U(),F.setAttributes=D(),F.insert=R().bind(null,"head"),F.domAPI=N(),F.insertStyleElement=z(),P()(W.A,F),W.A&&W.A.locals&&W.A.locals;let q=[],Y=!1;const G={onload:function({extensionAPI:e}){console.log("[TimeBlock] Loading extension..."),function(e){e.settings.panel.create({tabTitle:"TimeBlock",settings:[{id:"dayStartHour",name:"Day Start Hour",description:"Hour to start displaying in the calendar (0-23)",action:{type:"input",placeholder:"6"}},{id:"dayEndHour",name:"Day End Hour",description:"Hour to end displaying (0-30, where 24-30 = next day's 0-6 AM)",action:{type:"input",placeholder:"22"}},{id:"timeBlockTags",name:"Time Block Tags",description:"Tags that trigger time block parsing. Format: tag1, tag2, [[PageRef]]. Comma-separated.",action:{type:"input",placeholder:"longTerm, shortTerm, [[Meeting]]"}},{id:"tagColors",name:"Tag Colors",description:"Color for each tag. Format: tag:#color, tag2:#color2. Comma-separated.",action:{type:"input",placeholder:"longTerm:#4A90D9, shortTerm:#7CB342, Meeting:#F4511E"}},{id:"defaultColor",name:"Default Color",description:"Color for blocks without matching tags",action:{type:"input",placeholder:"#9E9E9E"}}]})}(e);const n=r(e);console.log("[TimeBlock] Settings loaded:",n);const t=function(){const n=document.createElement("span");n.id="timeblock-topbar-button",n.className="bp3-popover-wrapper",n.style.marginRight="4px";const t=document.createElement("span");t.className="bp3-popover-target";const o=document.createElement("span");return o.className="bp3-button bp3-minimal bp3-small",o.setAttribute("tabindex","0"),o.innerHTML='\n    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">\n      <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/>\n      <path d="M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>\n    </svg>\n  ',o.title="TimeBlock",o.onclick=()=>{!function(e){Y?(E(),Y=!1):(window.roamAlphaAPI.ui.rightSidebar.open(),function(e){B||(B=document.createElement("div"),B.id="timeblock-sidebar-container");const n=document.getElementById("right-sidebar");if(n&&!B.parentNode){const e=n.querySelector(".rm-sidebar-header, [class*='sidebar-header'], .flex-h-box");if(e&&e.nextSibling)e.parentNode?.insertBefore(B,e.nextSibling),console.log("[TimeBlock] Inserted after sidebar header");else{const e=n.firstElementChild;e?n.insertBefore(B,e.nextSibling||e):n.appendChild(B),console.log("[TimeBlock] Inserted into right-sidebar")}}else n||(console.error("[TimeBlock] Could not find #right-sidebar"),document.body.appendChild(B),B.style.position="fixed",B.style.right="20px",B.style.top="50px",B.style.width="300px",B.style.zIndex="9999",B.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",B.style.borderRadius="8px",B.style.overflow="hidden",console.log("[TimeBlock] Using floating panel fallback"));H||(H=s().createRoot(B)),H.render((0,a.jsx)(A,{extensionAPI:e}))}(e),Y=!0)}(e)},t.appendChild(o),n.appendChild(t),n}(),o=document.querySelector(".rm-topbar");if(o){const e=o.querySelector(".rm-topbar__spacer-sm");e?o.insertBefore(t,e):o.appendChild(t)}q.push(()=>{t.remove(),E()}),console.log("[TimeBlock] Extension loaded successfully")},onunload:function(){console.log("[TimeBlock] Unloading extension..."),q.forEach(e=>e()),q=[],console.log("[TimeBlock] Extension unloaded")}};export{G as default};